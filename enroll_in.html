<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Class_Enroll</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="{{url_for('static', filename='assets/img/favicon.ico')}}" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="{{url_for('static', filename='css/main.css')}}" rel="stylesheet" />
        
        <script language="javascript">
            function Rating(){};
            Rating.prototype.rate = 0;
            Rating.prototype.setRate = function(newrate){
                //별점 마킹 - 클릭한 별 이하 모든 별 체크 처리
                this.rate = newrate;
                let items = document.querySelectorAll('.rate_radio');
                items.forEach(function(item, idx){
                    if(idx < newrate){
                        item.checked = true;
                    }else{
                        item.checked = false;
                    }
                });
            }
            let rating = new Rating();

            document.addEventListener('DOMContentLoaded', function(){
                //별점선택 이벤트 리스너
                document.querySelector('.rating').addEventListener('click',function(e){
                    let elem = e.target;
                    if(elem.classList.contains('rate_radio')){
                        rating.setRate(parseInt(elem.value));
                        document.getElementById('rating').value = elem.value;
                    }
                })
            });

            function postForm(path, params, method) {
                method = method || 'post';
                var form = document.createElement('form');
                form.setAttribute('method', method);
                form.setAttribute('action', path);

                for (var key in params) {
                    if (params.hasOwnProperty(key)) {
                        var hiddenField = document.createElement('input');
                        hiddenField.setAttribute('type', 'hidden');
                        hiddenField.setAttribute('name', key);
                        hiddenField.setAttribute('value', params[key]);

                        form.appendChild(hiddenField);
                    }
                }

                document.body.appendChild(form);
                form.submit();
            }
        </script>
        
        
        
    </head>
    <body id="page-top">
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" href="#page-top">One-Day Class Platform</a>
                <button class="navbar-toggler navbar-toggler-right text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href="#" onclick="location.href='/main_class'">Class</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href="#" onclick="location.href='/community?page=0'">Community</a></li>
                        <li class="nav-item mx-0 mx-lg-1"><a class="nav-link py-3 px-0 px-lg-3 rounded" href="#" onclick="location.href='/logout'">Logout</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Class Section-->
        <section class="page-section bg-primary text-white mb-0" id="about">
            <div class="container">
                <!-- About Section Heading-->
                </br>
                </br>
                <h2 class="page-section-heading text-center text-uppercase text-white">{{_class['_source']['c_name']}}</h2>
                <!-- Icon Divider-->
                <div class="divider-custom divider-light">
                    <div class="divider-custom-line"></div>
                    <div class="divider-custom-icon"><i class="fas fa-star"></i></div>
                    <div class="divider-custom-line"></div>
                </div>
                <!-- About Section Content-->
                <div class="row">
                    <div class="col-lg-4 ml-auto"><img class="img-fluid" src="static/assets/img/photo/class.jpg" alt="" /></div>
                    <div class="col-lg-4 mr-auto"><p class="lead">클래스 설명</br>{{_class['_source']['c_content']}}</br>비용 : {{_class['_source']['cost']}}</br>시간 : {{_class['_source']['start']}} ~ {{_class['_source']['end']}}</p></div>
                </div>
                <!-- About Section Button-->
                {% if review == False %}
                <div class="text-center mt-4">
                    {% set class_id = _class['_id'] %}
                    <a class="btn btn-xl btn-outline-light" onclick="postForm('/payment', {'class_id':'{{class_id}}', 'b_category':'{{b_category}}', 's_category':'{{s_category}}'})">
                        <i class="fas fa-download mr-2"></i>
                        Enroll!
                    </a>
                </div>
                {% endif %}
            </div>
        </section>
        <!-- Review Section-->
        <section class="page-section" id="contact">
            <div class="container">
                <!-- Contact Section Heading-->
                <h2 class="page-section-heading text-center text-uppercase text-secondary mb-0">Review</h2>
                <!-- Contact Section Form-->
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                    {% if review == True %}
                    <form action="/review" method="post">
                        <input type="hidden" name="b_category" value="{{b_category}}">
                        <input type="hidden" name="s_category" value="{{s_category}}">
                        <input type="hidden" name="class_id" value="{{class_id}}">
                        <input type="hidden" name="rating" id="rating" value="0">
                        <p class="lead">id : {{ID}}</p>
                        <p class="lead">Please leave your rating and review</p>
                        <div class="rating">
                            <input type="checkbox" name="rating" id="rating1" value="1" class="rate_radio" title="1점">
                            <label for="rating1"></label>
                            <input type="checkbox" name="rating" id="rating2" value="2" class="rate_radio" title="2점">
                            <label for="rating2"></label>
                            <input type="checkbox" name="rating" id="rating3" value="3" class="rate_radio" title="3점">
                            <label for="rating3"></label>
                            <input type="checkbox" name="rating" id="rating4" value="4" class="rate_radio" title="4점">
                            <label for="rating4"></label>
                            <input type="checkbox" name="rating" id="rating5" value="5" class="rate_radio" title="5점">
                            <label for="rating5"></label>
                            
                        </div>
                        <!-- To configure the contact form email address, go to mail/contact_me.php and update the email address in the PHP file on line 19.--> 
                            <div class="control-group">
                                <div class="form-group floating-label-form-group controls mb-0 pb-2">
                                    <label>Review</label>
                                    <textarea class="form-control" name="review_content" id="review_content" rows="5" placeholder="Review" required="required" data-validation-required-message="Please enter a message."></textarea>
                                    <p class="help-block text-danger"></p>
                                </div>
                            </div>
                            <br />
                            <div id="success"></div>
                            <div class="form-group"><button class="btn btn-primary btn-xl" id="ReviewButton" type="submit" style="float:right;">Submit</button></div>
                    </form>
                    {% endif %}

                    <!-- 리뷰 출력-->
                    {% if reviews != -1 %}
                        {% for review in reviews %}
                            <div class="lead">
                                id : {{review['_source']['ID']}} &emsp; 점수 : {{review['_source']['rate']}}</br>
                                <내용></br>
                                {{review['_source']['content']}}
                            </div>
                            </br>
                        {% endfor %}
                    {% endif %}
                                                            
                    </div>
                </div>
            </div>
        </section>
      
        <!-- Footer-->
        <footer class="footer text-center">
            <div class="container">
                <div class="row">
                    <!-- Footer Made By-->
                    <div class="col-lg-12 mb-5 mb-lg-0">                    
                        <h4 class="text-uppercase mb-4">Made By</h4>
                        <p class="lead mb-0">
                            권수빈 &emsp;&emsp; 김은하
                            <br />
                            김찬솔 &emsp;&emsp; 이준협
                        </p>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Copyright Section-->
        <div class="copyright py-4 text-center text-white">
            <div class="container"><small>Copyright © Your Website 2020</small></div>
        </div>
        <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes)-->
        <div class="scroll-to-top d-lg-none position-fixed">
            <a class="js-scroll-trigger d-block text-center text-white rounded" href="#page-top"><i class="fa fa-chevron-up"></i></a>
        </div>
        
        <!-- Bootstrap core JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Third party plugin JS-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
        <!-- Contact form JS-->
        <script src="{{url_for('static', filename='static/assets/mail/jqBootstrapValidation.js')}}"></script>
        <script src="{{url_for('static', filename='static/assets/mail/contact_me.js')}}"></script>
        <!-- Core theme JS-->
        <script src="{{url_for('static', filename='/js/scripts.js')}}"></script>
    </body>
</html>
